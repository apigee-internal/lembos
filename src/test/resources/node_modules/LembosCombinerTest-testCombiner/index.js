'use strict';

module.exports = {
  config: {},

  map: function (key, value, context, cb) {
    // This is just required for the test but it actually isn't used

    // Here just in case the Error isn't thrown above
    cb();
  },

  combine: function (key, values, context, cb) {
    var total = 0;

    if (key !== "total") {
      throw new Error("Expected 'total' key but got the following: " + key);
    }

    while (values.hasNext()) {

      total += values.next();
    }
    context.write("total", total);
    cb();
  }
};
