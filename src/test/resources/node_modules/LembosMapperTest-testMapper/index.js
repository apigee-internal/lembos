'use strict';

var uniques = [];

module.exports = {
  config: {},

  mapSetup: function (context, cb) {
    this.mapKey = 'uniques';

    cb();
  },

  map: function (key, value, context, cb) {
    var timestamp = parseInt(key, 10); // Ensure we can properly marshal values

    if (uniques.indexOf(value) === -1) {
      context.write(this.mapKey, value);
      uniques.push(value);
    }

    cb();
  }
};
